package com.kickmogu.yodobashi.community.service;

import junit.framework.Assert;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.test.context.ContextConfiguration;

import com.kickmogu.lib.hadoop.hbase.HBaseContainer;
import com.kickmogu.lib.solr.SolrContainer;
import com.kickmogu.yodobashi.community.common.test.YcComJUnit4ClassRunner;
import com.kickmogu.yodobashi.community.resource.dao.CatalogProductDao;
import com.kickmogu.yodobashi.community.resource.domain.RecoverResultDO;
import com.kickmogu.yodobashi.community.resource.domain.VotingDO;
import com.kickmogu.yodobashi.community.resource.domain.constants.RecoverResultStatus;

@RunWith(YcComJUnit4ClassRunner.class)
@ContextConfiguration("/jcclientContext.xml")
public class ServiceTest {

	@Autowired @Qualifier("MySite")
	private HBaseContainer hBaseContainer;

	@Autowired @Qualifier("MySite")
	private SolrContainer solrContainer;

	@Autowired @Qualifier("default")
	protected CatalogProductDao catalogProductDao;

	@Autowired
	private RecoverService recoverService;

	@Test
	public void reCreateDatabase() {
	}

	@Test
	public void createHBaseTable() {
		hBaseContainer.getAdministrator().createTable(VotingDO.class);
	}

	@Test
	public void createSolrTable() {
		solrContainer.createSchemaDynamically(VotingDO.class);
	}

	@Test
	public void loadVariationProduct() {
		String[] skus = {
				"100000001001390279",
				"100000001000410414",
				"100000001000971125",
				"100000001001137624",
				"100000009000046682",
				"100000001001434068",
				"100000001001012459",
				"100000001001017362",
				"100000009000094751",
				"100000009000468786",
				"100000001001034799",
				"100000001000817283",
				"100000001001523033",
				"100000001000534477",
				"100000001000899896",
				"100000009000576292",
				"100000009000705883",
				"100000001001191938",
				"100000009000731824",
				"100000009000905550",
				"100000009000329134",
				"100000009000360276",
				"100000001000921906",
				"100000009000830112",
				"100000001000632737",
				"100000001000948971",
				"100000009000192302",
				"100000001001247800",
				"100000001001323655",
				"100000009000668583",
				"100000009000625576",
				"100000009000433997",
				"100000009000855282",
				"100000001001436635",
				"100000001001316985",
				"100000001001073086",
				"100000009000309750",
				"100000001001168533",
				"100000001001497632",
				"100000001000934690",
				"100000001001379197",
				"100000001001488385",
				"100000001001498784",
				"100000001000691608",
				"100000009000427846",
				"100000009000896774",
				"100000009000506785",
				"100000001001255088",
				"100000001001391629",
				"100000001001289424",
				"100000009000495090",
				"100000001001294800",
				"100000009000237548",
				"100000001000692942",
				"100000001001248469",
				"100000001001522470",
				"000000359102023510",
				"100000001001102605",
				"100000001000897994",
				"100000001001341995",
				"100000009000558158",
				"100000009000663994",
				"100000001001248057",
				"100000001000907240",
				"100000009000903626",
				"100000001000605836",
				"100000001000951550",
				"100000001001242805",
				"100000009000477905",
				"100000009000106979",
				"100000001000517804",
				"100000001001134774",
				"100000001000967259",
				"100000001001169787",
				"100000009000738450",
				"100000009000877354",
				"100000001001092735",
				"100000009000770289",
				"100000001000409305",
				"100000001001400554",
				"100000001000971015",
				"100000001001423462",
				"100000001001179828",
				"100000001000642610",
				"100000001000907841",
				"100000001000888894",
				"100000001001469438",
				"100000001001416223",
				"100000001000886290",
				"100000009000854904",
				"100000001000611921",
				"100000001000381490",
				"100000001001257292",
				"100000001000994810",
				"100000001000634567",
				"000000359109949583",
				"000000221656086471",
				"100000001000962607",
				"100000001001357558",
				"100000001000452268",
				"100000009000819762",
				"100000009000428842",
				"100000009000877488",
				"100000001000886335",
				"100000001001341228",
				"100000001001257643",
				"100000001001073660",
				"100000009000530046",
				"100000001000846802",
				"100000001000309113",
				"100000001001188257",
				"000000224407000948",
				"100000001000617606",
				"100000001001310774",
				"100000009000588342",
				"100000009000296543",
				"100000001000462537",
				"100000001001364562",
				"100000001001526065",
				"100000009000325756",
				"100000009000906095",
				"100000001000143916",
				"000000110451008148",
				"100000009000702811",
				"100000001000664248",
				"100000001001324490",
				"100000009000145175",
				"100000001000369426",
				"100000001001360376",
				"100000001000221460",
				"100000001001511526",
				"100000001001508418",
				"100000009000317346",
				"100000001001147165",
				"100000009000780738",
				"100000009000268494",
				"100000001001530526",
				"100000001000921615",
				"100000009000428848",
				"100000001000972469",
				"100000009000375380",
				"100000009000130647",
				"100000001000647643",
				"100000009000336297",
				"100000009000452704",
				"100000001001524231",
				"100000001001359265",
				"100000001001187974",
				"100000009000864093",
				"100000001001412973",
				"000000221654982825",
				"100000001001341578",
				"100000009000382404",
				"000000102358004225",
				"100000001001319991",
				"100000009000671397",
				"100000001001524176",
				"100000009000815877",
				"100000009000455860",
				"100000001001113299",
				"100000001001291789",
				"100000009000404315",
				"100000001001030725",
				"100000001001438590",
				"000000110391000396",
				"100000001001267791",
				"100000009000890293",
				"100000001000983666",
				"100000001001165585",
				"100000001000147828",
				"100000009000552275",
				"100000009000691995",
				"100000001001485625",
				"100000009000223198",
				"100000009000875100",
				"100000001000937734",
				"100000001000805374",
				"100000009000053757",
				"100000001000913651",
				"100000001001048029",
				"100000001000605354",
				"100000009000772581",
				"100000009000787985",
				"100000001000928355",
				"100000001000814971",
				"100000001000798907",
				"100000009000380895",
				"100000001001446315",
				"100000001001364719",
				"100000001000774450",
				"100000009000156826",
				"100000009000835037",
				"100000009000837228",
				"100000001001409801",
				"100000001000464385",
				"100000001001216377",
				"100000001000602816",
				"100000001001058802",
				"100000009000691488",
				"100000009000885812",
				"100000009000371984",
				"100000001000267586",
				"100000001001097186",
				"100000009000157279",
				"100000001000081845",
				"100000001001459137",
				"100000001001309564",
				"100000009000679309",
				"100000009000771841",
				"100000009000289923",
				"100000001001474718",
				"100000001001030721",
				"100000001001305802",
				"100000009000709276",
				"100000001001510184",
				"100000001000838603",
				"100000001001410231",
				"100000009000861735",
				"100000009000378405",
				"100000001001247951",
				"200000002000010007",
				"100000001000246211",
				"100000009000866061",
				"000000224509006313",
				"100000001000387193",
				"000000110292000761",
				"100000009000311524",
				"100000001001401961",
				"100000001001410700",
				"100000001001185371",
				"100000009000619278",
				"100000001001172736",
				"100000001001456515",
				"100000001001440589",
				"100000001001430580",
				"100000009000655910",
				"100000001001406302",
				"100000009000216880",
				"100000009000661290",
				"100000009000682211",
				"100000001001363423",
				"100000009000820460",
				"100000001000850201",
				"100000001000539007",
				"100000001001489368",
				"100000009000428329",
				"100000009000871570",
				"100000001000676496",
				"100000009000543997",
				"100000009000454686",
				"100000001001478823",
				"100000001000242651",
				"100000001001467599",
				"100000009000367253",
				"100000009000697118",
				"100000001000227419",
				"100000009000843229",
				"100000001001258030",
				"100000009000088600",
				"100000009000504571",
				"100000009000841378",
				"100000009000773159",
				"100000001001399092",
				"100000009000035134",
				"100000001001256355",
				"100000001001484308",
				"100000009000890015",
				"100000001000126390",
				"100000001001146727",
				"100000001001490848",
				"100000001001143406",
				"100000001001439528",
				"000000221654294647",
				"100000001001466752",
				"100000001001379161",
				"100000001001037833",
				"100000009000898593",
				"100000009000691980",
				"100000009000276184",
				"100000009000030014",
				"100000001000208233",
				"100000001000745327",
				"100000001001142388",
				"100000009000891682",
				"100000001001071807",
				"100000001001410679",
				"100000009000731600",
				"100000001000481560",
				"100000009000730261",
				"100000001001344076",
				"100000009000584515",
				"100000001000420205",
				"100000001001486757",
				"100000001001257396",
				"100000009000704567",
				"000000110412004266",
				"100000001001165868",
				"100000001001107480",
				"100000001001402461",
				"100000001000631340",
				"100000001001243952",
				"100000001001530539",
				"100000001001439013",
				"100000001001287353",
				"100000001001114956",
				"100000001001153712",
				"100000001001441284",
				"100000009000161420",
				"100000001001097495",
				"100000086580103939",
				"100000001001395514",
				"100000009000411070",
				"100000001000889576",
				"100000001001139912",
				"100000009000872706",
				"100000009000436492",
				"100000001001513297",
				"100000009000638081",
				"100000009000250773",
				"100000001001062924",
				"100000001001181764",
				"100000001000603034",
				"100000001001180906",
				"100000001001523837",
				"100000001000912017",
				"100000009000635125",
				"000000721725101394",
				"100000009000870684",
				"100000009000572669",
				"100000001001171694",
				"100000001001333028",
				"100000001000476528",
				"100000001000501262",
				"100000009000559514",
				"100000001000809157",
				"100000009000874679",
				"100000009000735935",
				"100000009000855638",
				"100000001001303398",
				"000000110395001191",
				"100000001001447396",
				"100000001001144580",
				"100000001001140511",
				"100000009000868592",
				"100000001001286353",
				"100000001001512531",
				"100000001001187627",
				"100000009000115201",
				"100000001000741477",
				"100000009000573259",
				"100000001000631300",
				"100000009000845164",
				"100000001000378407",
				"100000009000761143",
				"100000009000561143",
				"100000001000258996",
				"100000009000694338",
				"100000001000606791",
				"100000001001330220",
				"100000001000012106",
				"100000009000717347",
				"100000001001212032",
				"100000001000735339",
				"100000001000662405",
				"100000001001407654",
				"000000721759920338",
				"100000009000850978",
				"100000009000882188",
				"100000001001398285",
				"100000009000120109",
				"100000001001208689",
				"100000009000905183",
				"100000001001467724",
				"100000009000506587",
				"100000001001108251",
				"100000001001336812",
				"100000001001221399",
				"100000001000408427",
				"100000001000543319",
				"100000001001281506",
				"100000001001160440",
				"100000001001096011",
				"100000001001268802",
				"100000009000124181",
				"100000001001358205",
				"100000009000462825",
				"100000009000574356",
				"100000001000659824",
				"100000001001032936",
				"100000001000285190",
				"100000009000567305",
				"100000001000718818",
				"100000001000993924",
				"100000009000887447",
				"100000009000623775",
				"100000001001293895",
				"100000001001467983",
				"100000001001429044",
				"100000001001253622",
				"100000009000585722",
				"100000009000655492",
				"100000001001373209",
				"100000001000278237",
				"100000001000208284",
				"100000001001452782",
				"100000001000675040",
				"100000009000652865",
				"100000001001430354",
				"100000001001133632",
				"100000001001408026",
				"100000001000863109",
				"100000001000330957",
				"100000001001530373",
				"100000009000665254",
				"100000009000024991",
				"100000001000066730",
				"100000009000871689",
				"100000001001005176",
				"100000009000576868",
				"100000001001358844",
				"100000009000621799",
				"100000001001462370",
				"100000001001297207",
				"100000001001155772",
				"000000359103049332",
				"100000001000815346",
				"100000001001348100",
				"100000001001376544",
				"100000001000991856",
				"100000009000893816",
				"100000001001221395",
				"100000001001304620",
				"100000001001516376",
				"100000001000997814",
				"100000001001015760",
				"100000009000558485",
				"100000001000392660",
				"100000001000881663",
				"100000009000526016",
				"100000001001088062",
				"100000009000657475",
				"100000001001335166",
				"100000009000741908",
				"100000009000340671",
				"000000891801006870",
				"100000001000995602",
				"100000001001013282",
				"100000009000643962",
				"100000001000754576",
				"100000086580102681",
				"100000001001184781",
				"100000001000896928",
				"000000221654817535",
				"100000001001072050",
				"100000001001241686",
				"100000001001131779",
				"100000001001510165",
				"100000009000601937",
				"100000009000660070",
				"100000009000815852",
				"100000009000478828",
				"100000001001325056",
				"100000001001391633",
				"100000009000583755",
				"100000001000258541",
				"100000001000234849",
				"100000001001113337",
				"100000001001209458",
				"100000001001357531",
				"100000009000844304",
				"100000001001101897",
				"100000009000120692",
				"100000001000271135",
				"100000001000371662",
				"100000009000543446",
				"100000009000351004",
				"100000001001171938",
				"100000001001492862",
				"100000001001445659",
				"100000001001027468",
				"100000001001441555",
				"100000001000740899",
				"100000001001255826",
				"100000009000836819",
				"100000001001112055",
				"100000001001522547",
				"100000001001313529",
				"100000001001367787",
				"100000001000694872",
				"100000001000511276",
				"100000001001058372",
				"100000001001451517",
				"100000001001394933",
				"100000001001508825",
				"100000009000534082",
				"100000001001514897",
				"100000009000463432",
				"100000001001289480",
				"100000001001261130",
				"100000009000230970",
				"100000009000201415",
				"000000221627000212",
				"000000221627000536",
				"000000221627000970",
				"000000221627000988",
				"000000221627001296",
				"000000221627001307",
				"000000221627001570",
				"000000221627002050",
				"000000221627002220",
				"000000221627002658",
				"000000221627003169",
				"000000221627004456",
				"000000221627005405",
				"000000221627005939",
				"000000221627009236",
				"000000221627010181",
				"000000221627011073",
				"000000221627012111",
				"000000221627012905",
				"000000221627014991",
				"000000221627017560",
				"000000221627021174",
				"000000221627022319",
				"100000009000011752",
				"100000009000015578",
				"100000009000021121",
				"100000009000024339",
				"100000009000027737",
				"100000009000033069",
				"100000009000035814",
				"100000009000038534",
				"100000009000041358",
				"100000009000053057",
				"100000009000058621",
				"100000009000079634",
				"100000009000082189",
				"100000009000092385",
				"100000009000109591",
				"100000009000114315",
				"100000009000127136",
				"100000009000134910",
				"100000009000145390",
				"100000009000152831",
				"100000009000190746",
				"100000009000193707",
				"100000009000213137",
				"100000009000241484",
				"100000009000237287",
				"100000009000237501",
				"100000009000432095",
				"100000009000476939",
				"100000009000404327"
			};

		catalogProductDao.initialLoadVariationProductsBySku(skus);
	}

	@Test
	public void recoverReviewPoint(){
		String reviewId = "300000q8jIf0400uKtFf0";

		RecoverResultDO recoverResult = recoverService.recoverReviewPoint(reviewId, true);

		Assert.assertTrue(RecoverResultStatus.SUCCESS.equals(recoverResult.getResultStatus()));
	}

	@Test
	public void recoverReviewPointResultSuspend(){
		String reviewId = "300000ACjIf0300AKtFf0";

		RecoverResultDO recoverResult = recoverService.recoverReviewPoint(reviewId, true);

		Assert.assertTrue(RecoverResultStatus.SUSPEND.equals(recoverResult.getResultStatus()));

	}
}
